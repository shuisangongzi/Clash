# é…ç½®åç§° Clash é…ç½®
# é€‚ç”¨èŒƒå›´ Mihomo å†…æ ¸

# åŸºæœ¬é…ç½®
mixed-port: 7890
ipv6: true
allow-lan: true
unified-delay: true
tcp-concurrent: true

external-controller: 127.0.0.1:9090
#external-ui: ui
#external-ui-url: "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"

find-process-mode: strict
global-client-fingerprint: chrome

# ç¼“å­˜è®¾ç½®
profile:
  store-selected: true
  store-fake-ip: true

# å—…æ¢è®¾ç½®
sniffer:
  enable: false
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

# TUNè®¾ç½®
tun:
  enable: true
  stack: mixed
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-detect-interface: true

# DNSè®¾ç½®
dns:
  enable: true
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*"
    - "+.lan"
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query

# é”šç‚¹ èŠ‚ç‚¹è®¢é˜…å‚æ•°
# æ¯24å°æ—¶æ›´æ–°ä¸€æ¬¡ï¼Œæ¯10åˆ†é’Ÿä¸€æ¬¡å¥åº·æ£€æŸ¥
NodeParam:
  &NodeParam
    type: http
    interval: 86400
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 600

# èŠ‚ç‚¹è®¢é˜…
proxy-providers:
  Clash:
    <<: *NodeParam
    path: './Sub/Clash.yaml'
    url: 'è‡ªå·±é“¾æ¥'

# é”šç‚¹ æ—¶å»¶ä¼˜é€‰å‚æ•°
# æ¯6ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œå®¹å·®20msï¼Œæ—¶å»¶è¶…2ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥3æ¬¡è§¦å‘å¥åº·æ£€æŸ¥
UrlTest:
  &UrlTest
    type: url-test
    interval: 6
    tolerance: 20
    lazy: true
    url: http://www.gstatic.com/generate_204
    disable-udp: false
    timeout: 2000
    max-failed-times: 3
    hidden: true
    include-all-providers: true
    
# é”šç‚¹ æ•…éšœè½¬ç§»å‚æ•°
# æ¯6ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œæ—¶å»¶è¶…2ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥3æ¬¡è§¦å‘å¥åº·æ£€æŸ¥
FallBack:
  &FallBack
    type: fallback
    interval: 6
    lazy: true
    url: http://www.gstatic.com/generate_204
    disable-udp: false
    timeout: 2000
    max-failed-times: 3
    hidden: true
    include-all-providers: true
    
# é”šç‚¹ è´Ÿè½½å‡è¡¡å‚æ•°
# æ¯6ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œæ—¶å»¶è¶…2ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥3æ¬¡è§¦å‘å¥åº·æ£€æŸ¥
LoadBalance:
  &LoadBalance
    type: load-balance
    interval: 6
    lazy: true
    url: http://www.gstatic.com/generate_204
    disable-udp: false
    strategy: consistent-hashing
    timeout: 2000
    max-failed-times: 3
    hidden: true
    include-all-providers: true

# é”šç‚¹ è§„åˆ™ç±»å‹å‚æ•°
# æ¯24å°æ—¶æ›´æ–°ä¸€æ¬¡
# ç»å…¸åŒ¹é…
classical:
  &classical
    type: http
    behavior: classical
    interval: 86400
    format: yaml

# æ–‡æœ¬åŒ¹é…
text:
  &text
    type: http
    behavior: classical
    interval: 86400
    format: text

# åŸŸååŒ¹é…
domain:
  &domain
    type: http
    behavior: domain
    interval: 86400
    format: yaml

# IPåŒ¹é…
ipcidr:
  &ipcidr
    type: http
    behavior: ipcidr
    interval: 86400
    format: yaml

# æœ¬åœ°ç­–ç•¥
proxies:
  - name: ç›´æ¥è¿æ¥
    type: direct
    udp: true

  - name: æ‹’ç»è¿æ¥
    type: reject

# ä»£ç†ç­–ç•¥
proxy-groups:
  - name: å…¨éƒ¨èŠ‚ç‚¹
    type: select
    icon: https://raw.githubusercontent.com/shuisangongzi/icon/refs/heads/main/Clash.png
    url: http://www.gstatic.com/generate_204
    include-all-providers: true

  - name: æ¼ç½‘ä¹‹é±¼
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Catnet.png
    proxies:
      - ç›´æ¥è¿æ¥
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - æ–°å›½èŠ‚ç‚¹
      - ç¾å›½èŠ‚ç‚¹

  - name: éšç§ä¿æŠ¤
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hijacking.png
    proxies:
      - æ‹’ç»è¿æ¥
      - ç›´æ¥è¿æ¥

  - name: è§„åˆ™ä¿®æ­£
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Area.png
    proxies:
      - å…¨çƒæœåŠ¡
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - æ–°å›½èŠ‚ç‚¹
      - ç¾å›½èŠ‚ç‚¹

  - name: ç”µæŠ¥æœåŠ¡
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
    proxies:
      - å…¨çƒæœåŠ¡
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - æ–°å›½èŠ‚ç‚¹
      - ç¾å›½èŠ‚ç‚¹

  - name: å¾®è½¯æœåŠ¡
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Microsoft.png
    proxies:
      - å…¨çƒæœåŠ¡
      - ç›´æ¥è¿æ¥
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - æ–°å›½èŠ‚ç‚¹
      - ç¾å›½èŠ‚ç‚¹

  - name: å…¨çƒæœåŠ¡
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    proxies:
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - æ–°å›½èŠ‚ç‚¹
      - ç¾å›½èŠ‚ç‚¹
      - ç›´æ¥è¿æ¥

  - name: å¤§é™†æœåŠ¡
    type: select
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China_Map.png
    proxies:
      - ç›´æ¥è¿æ¥
      - æ‹’ç»è¿æ¥

# èŠ‚ç‚¹ç­–ç•¥
  - name: é¦™æ¸¯èŠ‚ç‚¹
    type: select
    icon: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Gallery/Color/HK.png
    proxies:
      - é¦™æ¸¯ä¼˜é€‰
      - é¦™æ¸¯è½¬ç§»
      - é¦™æ¸¯å‡è¡¡

  - name: å°æ¹¾èŠ‚ç‚¹
    type: select
    icon: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Gallery/Color/TW.png
    proxies:
      - å°æ¹¾ä¼˜é€‰
      - å°æ¹¾è½¬ç§»
      - å°æ¹¾å‡è¡¡

  - name: æ—¥æœ¬èŠ‚ç‚¹
    type: select
    icon: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Gallery/Color/JP.png
    proxies:
      - æ—¥æœ¬ä¼˜é€‰
      - æ—¥æœ¬è½¬ç§»
      - æ—¥æœ¬å‡è¡¡

  - name: æ–°å›½èŠ‚ç‚¹
    type: select
    icon: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Gallery/Color/SG.png
    proxies:
      - æ–°å›½ä¼˜é€‰
      - æ–°å›½è½¬ç§»
      - æ–°å›½å‡è¡¡

  - name: ç¾å›½èŠ‚ç‚¹
    type: select
    icon: https://raw.githubusercontent.com/Centralmatrix3/Matrix-io/master/Gallery/Color/US.png
    proxies:
      - ç¾å›½ä¼˜é€‰
      - ç¾å›½è½¬ç§»
      - ç¾å›½å‡è¡¡

# æ—¶å»¶ä¼˜é€‰
  - name: é¦™æ¸¯ä¼˜é€‰
    <<: *UrlTest
    filter: é¦™æ¸¯|æ¸¯|HK|ğŸ‡­ğŸ‡°|(?i)Hong

  - name: å°æ¹¾ä¼˜é€‰
    <<: *UrlTest
    filter: å°æ¹¾|å°|TW|ğŸ‡¹ğŸ‡¼|(?i)Taiwan

  - name: æ—¥æœ¬ä¼˜é€‰
    <<: *UrlTest
    filter: æ—¥æœ¬|æœ¬|JP|ğŸ‡¯ğŸ‡µ|(?i)Japan

  - name: æ–°å›½ä¼˜é€‰
    <<: *UrlTest
    filter: æ–°åŠ å¡|ç‹®|SG|ğŸ‡¸ğŸ‡¬|(?i)Singapore

  - name: ç¾å›½ä¼˜é€‰
    <<: *UrlTest
    filter: ç¾å›½|ç¾|US|ğŸ‡ºğŸ‡¸|(?i)States

# æ•…éšœè½¬ç§»
  - name: é¦™æ¸¯è½¬ç§»
    <<: *FallBack
    filter: é¦™æ¸¯|æ¸¯|HK|ğŸ‡­ğŸ‡°|(?i)Hong

  - name: å°æ¹¾è½¬ç§»
    <<: *FallBack
    filter: å°æ¹¾|å°|TW|ğŸ‡¹ğŸ‡¼|(?i)Taiwan

  - name: æ—¥æœ¬è½¬ç§»
    <<: *FallBack
    filter: æ—¥æœ¬|æœ¬|JP|ğŸ‡¯ğŸ‡µ|(?i)Japan

  - name: æ–°å›½è½¬ç§»
    <<: *FallBack
    filter: æ–°åŠ å¡|ç‹®|SG|ğŸ‡¸ğŸ‡¬|(?i)Singapore

  - name: ç¾å›½è½¬ç§»
    <<: *FallBack
    filter: ç¾å›½|ç¾|US|ğŸ‡ºğŸ‡¸|(?i)States

# è´Ÿè½½å‡è¡¡
  - name: é¦™æ¸¯å‡è¡¡
    <<: *LoadBalance
    filter: é¦™æ¸¯|æ¸¯|HK|ğŸ‡­ğŸ‡°|(?i)Hong

  - name: å°æ¹¾å‡è¡¡
    <<: *LoadBalance
    filter: å°æ¹¾|å°|TW|ğŸ‡¹ğŸ‡¼|(?i)Taiwan

  - name: æ—¥æœ¬å‡è¡¡
    <<: *LoadBalance
    filter: æ—¥æœ¬|æœ¬|JP|ğŸ‡¯ğŸ‡µ|(?i)Japan

  - name: æ–°å›½å‡è¡¡
    <<: *LoadBalance
    filter: æ–°åŠ å¡|ç‹®|SG|ğŸ‡¸ğŸ‡¬|(?i)Singapore

  - name: ç¾å›½å‡è¡¡
    <<: *LoadBalance
    filter: ç¾å›½|ç¾|US|ğŸ‡ºğŸ‡¸|(?i)States

# è®¢é˜…è§„åˆ™
rule-providers:
  è§„åˆ™ä¿®æ­£:
    <<: *text
    path: './rules/Proxy.text'
    url: https://raw.githubusercontent.com/shuisangongzi/Clash/refs/heads/main/Proxy.text

  å±€åŸŸç½‘ç»œ:
    <<: *classical
    path: './rules/Lan.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Lan/Lan_No_Resolve.yaml

  éšç§ä¿æŠ¤:
    <<: *classical
    path: './rules/Privacy.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Privacy/Privacy_No_Resolve.yaml

  éšç§åŸŸå:
    <<: *domain
    path: './rules/Privacy_Domain.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Privacy/Privacy_Domain.yaml

  è¿è¥åŠ«æŒ:
    <<: *classical
    path: './rules/Hijacking.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Hijacking/Hijacking_No_Resolve.yaml

  ç”µæŠ¥æœåŠ¡:
    <<: *classical
    path: './rules/Telegram.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Telegram/Telegram_No_Resolve.yaml

  å¾®è½¯æœåŠ¡:
    <<: *classical
    path: './rules/Microsoft.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Microsoft/Microsoft_No_Resolve.yaml

  å…¨çƒæœåŠ¡:
    <<: *classical
    path: './rules/Global.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Global/Global_No_Resolve.yaml

  å…¨çƒåŸŸå:
    <<: *domain
    path: './rules/Global_Domain.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Global/Global_Domain.yaml

  å¤§é™†æœåŠ¡:
    <<: *classical
    path: './rules/ChinaMax.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/ChinaMax/ChinaMax.yaml

  å¤§é™†åŸŸå:
    <<: *domain
    path: './rules/ChinaMax_Domain.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/ChinaMax/ChinaMax_Domain.yaml

  å¤§é™†IP:
    <<: *ipcidr
    path: './rules/ChinaMax_IP.yaml'
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/ChinaMax/ChinaMax_IP.yaml

# è§„åˆ™æŒ‡å‘
rules:
  - RULE-SET,è§„åˆ™ä¿®æ­£,è§„åˆ™ä¿®æ­£
  - RULE-SET,éšç§ä¿æŠ¤,éšç§ä¿æŠ¤
  - RULE-SET,éšç§åŸŸå,éšç§ä¿æŠ¤
  - RULE-SET,è¿è¥åŠ«æŒ,éšç§ä¿æŠ¤
  - RULE-SET,ç”µæŠ¥æœåŠ¡,ç”µæŠ¥æœåŠ¡
  - RULE-SET,å¾®è½¯æœåŠ¡,å¾®è½¯æœåŠ¡
  - RULE-SET,å…¨çƒæœåŠ¡,å…¨çƒæœåŠ¡
  - RULE-SET,å…¨çƒåŸŸå,å…¨çƒæœåŠ¡
  - RULE-SET,å¤§é™†æœåŠ¡,å¤§é™†æœåŠ¡
  - RULE-SET,å¤§é™†åŸŸå,å¤§é™†æœåŠ¡
  - RULE-SET,å¤§é™†IP,å¤§é™†æœåŠ¡,no-resolve
  - RULE-SET,å±€åŸŸç½‘ç»œ,ç›´æ¥è¿æ¥
  - MATCH,æ¼ç½‘ä¹‹é±¼
